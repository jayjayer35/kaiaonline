<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Outer Wilds Ship Log Styled</title>
<style>
  html, body {
    margin: 0;
    padding: 0;
    background: radial-gradient(ellipse at center, #000010 0%, #000000 100%);
    overflow: hidden;
    height: 100%;
  }
  canvas {
    display: block;
  }
  .tooltip {
    position: absolute;
    background: rgba(0,0,0,0.9);
    color: #99ccff;
    padding: 6px 10px;
    border-radius: 6px;
    pointer-events: none;
    font-family: "Trebuchet MS", sans-serif;
    font-size: 14px;
    white-space: nowrap;
    border: 1px solid #333;
    box-shadow: 0 0 6px #229;
  }
</style>
</head>
<body>
<canvas id="log"></canvas>
<div class="tooltip" id="tooltip" style="display:none;"></div>
<script>
const canvas = document.getElementById('log');
const ctx = canvas.getContext('2d');
const tooltip = document.getElementById('tooltip');

let width = window.innerWidth;
let height = window.innerHeight;
canvas.width = width;
canvas.height = height;

window.addEventListener('resize', () => {
  width = window.innerWidth;
  height = window.innerHeight;
  canvas.width = width;
  canvas.height = height;
  draw();
});

const nodes = [
  { id: 1, text: 'The Sun Station', x: width/2, y: height/2, expanded: true, parent: null },
  { id: 2, text: 'Sun Station Project', x: width/2 + 250, y: height/2 - 150, expanded: false, parent: 1 },
  { id: 3, text: 'Ash Twin Project', x: width/2 + 250, y: height/2 + 150, expanded: false, parent: 1 },
  { id: 4, text: 'White Hole Station', x: width/2 + 500, y: height/2, expanded: false, parent: 3 },
];

function getNode(id) {
  return nodes.find(n => n.id === id);
}

function isVisible(node) {
  if (node.parent === null) return true;
  const parent = getNode(node.parent);
  return parent.expanded && isVisible(parent);
}

let animationOffset = 0;

function draw() {
  ctx.clearRect(0,0,width,height);

  // Draw animated lines
  nodes.forEach(node => {
    if (node.parent !== null && isVisible(node) && isVisible(getNode(node.parent))) {
      const parent = getNode(node.parent);
      const dx = node.x - parent.x;
      const dy = node.y - parent.y;
      const len = Math.sqrt(dx*dx + dy*dy);
      const segments = Math.floor(len / 10);
      ctx.strokeStyle = '#44f';
      ctx.lineWidth = 2;
      for (let i = 0; i < segments; i++) {
        const phase = (i * 10 + animationOffset) % 20;
        if (phase < 10) {
          const t1 = i / segments;
          const t2 = (i + 0.5) / segments;
          const x1 = parent.x + dx * t1;
          const y1 = parent.y + dy * t1;
          const x2 = parent.x + dx * t2;
          const y2 = parent.y + dy * t2;
          ctx.beginPath();
          ctx.moveTo(x1, y1);
          ctx.lineTo(x2, y2);
          ctx.stroke();
        }
      }
    }
  });

  // Draw nodes
  nodes.forEach(node => {
    if (isVisible(node)) {
      // Outer glow
      ctx.beginPath();
      ctx.arc(node.x, node.y, 22, 0, Math.PI * 2);
      ctx.fillStyle = 'rgba(34, 51, 102, 0.5)';
      ctx.fill();

      // Main circle
      ctx.beginPath();
      ctx.arc(node.x, node.y, 18, 0, Math.PI * 2);
      ctx.fillStyle = '#000';
      ctx.fill();
      ctx.strokeStyle = '#44f';
      ctx.lineWidth = 3;
      ctx.stroke();

      // Text
      ctx.fillStyle = '#99ccff';
      ctx.font = '14px Trebuchet MS';
      ctx.textAlign = 'center';
      ctx.fillText(node.text, node.x, node.y - 28);
    }
  });
}

canvas.addEventListener('click', (e) => {
  const rect = canvas.getBoundingClientRect();
  const mx = e.clientX - rect.left;
  const my = e.clientY - rect.top;

  nodes.forEach(node => {
    if (isVisible(node)) {
      const dx = mx - node.x;
      const dy = my - node.y;
      if (dx*dx + dy*dy < 400) {
        node.expanded = !node.expanded;
      }
    }
  });
});

canvas.addEventListener('mousemove', (e) => {
  const rect = canvas.getBoundingClientRect();
  const mx = e.clientX - rect.left;
  const my = e.clientY - rect.top;

  let found = false;
  nodes.forEach(node => {
    if (isVisible(node)) {
      const dx = mx - node.x;
      const dy = my - node.y;
      if (dx*dx + dy*dy < 400) {
        tooltip.style.left = (e.clientX + 10) + 'px';
        tooltip.style.top = (e.clientY + 10) + 'px';
        tooltip.textContent = node.text;
        tooltip.style.display = 'block';
        found = true;
      }
    }
  });
  if (!found) {
    tooltip.style.display = 'none';
  }
});

function animate() {
  animationOffset += 1;
  draw();
  requestAnimationFrame(animate);
}

animate();
</script>
</body>
</html>
